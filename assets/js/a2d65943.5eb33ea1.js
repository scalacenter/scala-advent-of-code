"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8071],{8368:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var a=n(7462),o=(n(7294),n(3905)),i=n(6340);const s={},l="Day 14: Restroom Redoubt",r={unversionedId:"2024/puzzles/day14",id:"2024/puzzles/day14",title:"Day 14: Restroom Redoubt",description:"by Bulby",source:"@site/target/mdoc/2024/puzzles/day14.md",sourceDirName:"2024/puzzles",slug:"/2024/puzzles/day14",permalink:"/scala-advent-of-code/2024/puzzles/day14",draft:!1,editUrl:"https://github.com/scalacenter/scala-advent-of-code/edit/website/docs/2024/puzzles/day14.md",tags:[],version:"current",frontMatter:{},sidebar:"adventOfCodeSidebar",previous:{title:"Day 13: Claw Contraption",permalink:"/scala-advent-of-code/2024/puzzles/day13"},next:{title:"Day 15: Warehouse Woes",permalink:"/scala-advent-of-code/2024/puzzles/day15"}},p={},c=[{value:"Puzzle description",id:"puzzle-description",level:2},{value:"Solution Summary",id:"solution-summary",level:2},{value:"Part 1",id:"part-1",level:2},{value:"Part 2",id:"part-2",level:2},{value:"Final Code",id:"final-code",level:2},{value:"Run it in the browser",id:"run-it-in-the-browser",level:2},{value:"Part 1",id:"part-1-1",level:3},{value:"Part 2",id:"part-2-1",level:3},{value:"Solutions from the community",id:"solutions-from-the-community",level:2}],u={toc:c};function m(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"day-14-restroom-redoubt"},"Day 14: Restroom Redoubt"),(0,o.kt)("p",null,"by ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/TheDrawingCoder-Gamer"},"Bulby")),(0,o.kt)("h2",{id:"puzzle-description"},"Puzzle description"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://adventofcode.com/2024/day/14"},"https://adventofcode.com/2024/day/14")),(0,o.kt)("h2",{id:"solution-summary"},"Solution Summary"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Parse input into a ",(0,o.kt)("inlineCode",{parentName:"li"},"List[Robot]")),(0,o.kt)("li",{parentName:"ol"},"Make function to advance state by ",(0,o.kt)("inlineCode",{parentName:"li"},"n")," steps"),(0,o.kt)("li",{parentName:"ol"},"Solve")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"For ",(0,o.kt)("inlineCode",{parentName:"li"},"part1"),", this is advancing the state by 100 then calculating the safety score"),(0,o.kt)("li",{parentName:"ul"},"For ",(0,o.kt)("inlineCode",{parentName:"li"},"part2"),", this is finding the first state where a christmas tree is visible")),(0,o.kt)("h2",{id:"part-1"},"Part 1"),(0,o.kt)("p",null,"Part 1 shouldn't be too bad. Let's get started with our ",(0,o.kt)("inlineCode",{parentName:"p"},"Robot")," class (and a ",(0,o.kt)("inlineCode",{parentName:"p"},"Vec2i")," class):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"case class Vec2i(x: Int, y: Int)\n\ncase class Robot(pos: Vec2i, velocity: Vec2i)\n")),(0,o.kt)("p",null,"Now we can parse our input: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},'def parse(str: String): List[Robot] =\n  str.linesIterator.map:\n    case s"p=$px,$py v=$vx,$vy" =>\n      Robot(Vec2i(px.toInt, py.toInt), Vec2i(vx.toInt, vy.toInt))\n  .toList\n')),(0,o.kt)("p",null,"Let's define our grid size in a ",(0,o.kt)("inlineCode",{parentName:"p"},"val"),", as it can depend on if we are doing a test input or not:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"val size = Vec2i(101, 103)\n")),(0,o.kt)("p",null,"The problem text states that when a robot goes off the edge it comes back on the other side, which sounds a lot like modulo.\nUnfortunately, modulo is incorrect in our case for negative numbers. Let's define a remainder instead:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"extension (self: Int)\n  infix def rem(that: Int): Int =\n    val m = math.abs(self) % that\n    if self < 0 then\n      that - m\n    else\n      m\n")),(0,o.kt)("p",null,"Now we can add a function to ",(0,o.kt)("inlineCode",{parentName:"p"},"Robot")," that advances the state by ",(0,o.kt)("inlineCode",{parentName:"p"},"n"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"case class Robot(pos: Vec2i, velocity: Vec2i):\n  def stepN(n: Int = 1): Robot =\n    copy(pos = pos.copy(x = (pos.x + n * velocity.x) rem size.x, y = (pos.y + n * velocity.y) rem size.y))\n")),(0,o.kt)("p",null,"Now for the full ",(0,o.kt)("inlineCode",{parentName:"p"},"List[Robot]"),", we can add ",(0,o.kt)("inlineCode",{parentName:"p"},"stepN")," to that too, and also define our safety function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"extension (robots: List[Robot])\n  def stepN(n: Int = 1): List[Robot] = robots.map(_.stepN(n))\n\n  def safety: Int =\n    val middleX = size.x / 2\n    val middleY = size.y / 2\n\n    robots.groupBy: robot =>\n      (robot.pos.x.compareTo(middleX), robot.pos.y.compareTo(middleY)) match\n        case (0, _) | (_, 0) => -1\n        case ( 1, -1) => 0\n        case (-1, -1) => 1\n        case (-1,  1) => 2\n        case ( 1,  1) => 3\n    .removed(-1).values.map(_.length).product\n")),(0,o.kt)("p",null,"Let's explain this a little. There are 4 quadrants, and as specified there are also lines that aren't in any quadrant.\nWe can use ",(0,o.kt)("inlineCode",{parentName:"p"},"groupBy")," to group the robots into quadrants."),(0,o.kt)("p",null,"First, we get the midpoints by dividing the size by 2. We then compare the robot to the midpoint, returning ",(0,o.kt)("inlineCode",{parentName:"p"},"-1")," if it's on the line\n(either comparison is equal), and otherwise sort the remaining 4 results into quadrants. We then remove the robots on the line,\nget the length of each of the lists, and multiply them together."),(0,o.kt)("p",null,"With this ",(0,o.kt)("inlineCode",{parentName:"p"},"part1")," is easy to implement:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"def part1(input: String): Int = parse(input).stepN(100).safety\n")),(0,o.kt)("h2",{id:"part-2"},"Part 2"),(0,o.kt)("p",null,"Part 2 wants us to find an image which is really hard. Thankfully, there is one thing I know about Christmas trees: They have\na lot of lines in a row and are an organized shape. "),(0,o.kt)("p",null,'We are assuming here that the tree is solid. This assumption is fine in this case, the space to search is finite\nso the worst we can get is a "not found" answer, but in other problems we may want to be more sure about our input.'),(0,o.kt)("p",null,"The christmas trees I know are really tall, but only in a few columns. So let's test the vertical columns for a few lines that are really long.\nThey also have a lot of shorter horizontal lines, so let's also check the rows for a lot of shorter lines."),(0,o.kt)("p",null,"Let's also inspect the input more: the grid size is 101 wide and 103 tall. If we've moved vertically 103 times, then we've moved a multiple\nof 103 and are thus back at the start. The same logic applies for horizontal movement, but with 101 instead. This means a robot can, at most, be in\n101 * 103 unique positions, or 10,403, and because all robots are moved at the same time there will only ever be 10,403 unique states. This lets us\nfail fast while writing our code in case we messed something up."),(0,o.kt)("p",null,"This is arbitrary and only really possible by print debugging your code, but here's my final code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"extension (robots: List[Robot])\n  def findEasterEgg: Int =\n    (0 to (size.x * size.y)).find: i =>\n      val newRobots = robots.stepN(i)\n      newRobots.groupBy(_.pos.y).count(_._2.length >= 10) > 15 && newRobots.groupBy(_.pos.x).count(_._2.length >= 15) >= 3\n    .getOrElse(-1)\n")),(0,o.kt)("p",null,"We don't even need to check if the lines are contiguous - our test is strict enough with counting lines that it works regardless. Results may vary\non your input. Here I test if there are more than 15 horizontal lines with a length of 10 or more, and that there are 3 or more vertical lines\nwith length 15 or greater."),(0,o.kt)("p",null,"Then let's hook it up to ",(0,o.kt)("inlineCode",{parentName:"p"},"part2"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},"def part2(input: String): Int = parse(input).findEasterEgg\n")),(0,o.kt)("p",null,"My Christmas tree looks like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"......................................................................................................\n.................................................#....................................................\n..............................................#.......................................................\n................#.#............................#......................................................\n.................................................................................#....................\n................................................................................................#.....\n..#...................................................................................................\n.....#........................................................................................#.......\n.#....................................................................................................\n......................................................................................................\n...........................................................#...........#........#.....................\n.........#..........................................#.........#.......................................\n..............................................#........#..............................................\n.......................................#..........#...................................................\n...................................................................................#.............#....\n............................................................#.........................................\n.................#.......................#.............................#..............................\n.............................#........................................................................\n.................................#...............................#.........................#..........\n.........#........................#..........................................#........................\n......................................................................................................\n.............................#........................................................................\n.......#.............................#....#...........................................................\n...#..............................................................#......................#............\n..........................#............................................#..............................\n.......................................................................................#..............\n..............................................#.......................................................\n.............#.......................................................................#................\n............#.................................#.....#.......................................#.........\n......................................................................................................\n................###############################.......................................................\n................#.............................#.......................................................\n................#.............................#.....#........................#........................\n................#.............................#.................#.....................................\n................#.............................#.......................................................\n................#..............#..............#.......................................................\n................#.............###.............#....#.........................................#........\n................#............#####............#.......................................................\n................#...........#######...........#.......................................................\n................#..........#########..........#.......................................................\n......#.........#............#####............#......................................................#\n................#...........#######...........#.......................................................\n................#..........#########..........#....................#...............................#..\n................#.........###########.........#........................................#..............\n...#......#.....#........#############........#..#....................................................\n................#..........#########..........#..............#.....................................#..\n................#.........###########.........#.......................................................\n................#........#############........#............................................#..........\n................#.......###############.......#.......................................................\n..........#.....#......#################......#.......................................................\n................#........#############........#..........................#.........#..................\n................#.......###############.......#....................................................#..\n........#.......#......#################......#......................................................#\n................#.....###################.....#.......................................................\n................#....#####################....#..#....................................................\n................#.............###.............#..........#............................................\n................#.............###.............#......................#................................\n................#.............###.............#..........................#............................\n................#.............................#.......................#...............................\n................#.............................#....................................#..................\n................#.............................#......................................#................\n......#.........#.............................#.......................................................\n................###############################............................#..........................\n......................................................................................................\n...............#...........................................#..........................................\n.........................................#............................................................\n...................#.........................................................#........................\n.....................................#.............................................................#..\n...........................#....................#.....................................................\n..........................................................#...........................#...............\n......................................................................................................\n..#............#................#............................................#........................\n........................................#..#..........................................................\n...........#......................................................................#...................\n............#..........#...............................................................#.#............\n............................................................#.........................................\n...#......................................................................#...........................\n.....#................................................................................................\n......................................................................................................\n......................................................................................................\n............................................#......................................#..................\n...............#............................................................#.........................\n........................................#.............................................................\n............#..#......................................................................................\n...........#.............#.................#..........................................................\n................................#.....................................................................\n.........#.................................#..........................................................\n.......................#............................................................................#.\n...............#......................................................................................\n..............................#.#.....................................................................\n......................................................................................................\n......................................................................................................\n...........#..........................................................................................\n.........................................................................................#............\n..........................#...........................................................................\n...............................#.......................#..............................................\n...............#......................................................................................\n...........#...............................#..........................................................\n.................#.................#............................................#...#.................\n...................................................................................................#..\n...............................................................................#......................\n....#...................................................................#.............................\n........#...................#.....................#...................................................\n................................................................................#.....................\n")),(0,o.kt)("p",null,"With this information of how this looks we could make a smarter ",(0,o.kt)("inlineCode",{parentName:"p"},"findEasterEgg")," with the knowledge of the border. The border\nmakes it much easier as we only have to check for 2 contiguous lines in each dimension."),(0,o.kt)("h2",{id:"final-code"},"Final Code"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-scala"},'case class Vec2i(x: Int, y: Int)\n\nval size = Vec2i(101, 103)\n\nextension (self: Int)\n  infix def rem(that: Int): Int =\n    val m = math.abs(self) % that\n    if self < 0 then\n      that - m\n    else\n      m\n\ncase class Robot(pos: Vec2i, velocity: Vec2i)\n  def stepN(n: Int = 1): Robot =\n    copy(pos = pos.copy(x = (pos.x + n * velocity.x) rem size.x, y = (pos.y + n * velocity.y) rem size.y))\n\ndef parse(str: String): List[Robot] =\n  str.linesIterator.map:\n    case s"p=$px,$py v=$vx,$vy" =>\n      Robot(Vec2i(px.toInt, py.toInt), Vec2i(vx.toInt, vy.toInt))\n  .toList\n\nextension (robots: List[Robot])\n  def stepN(n: Int = 1): List[Robot] = robots.map(_.stepN(n))\n\n  def safety: Int =\n    val middleX = size.x / 2\n    val middleY = size.y / 2\n\n    robots.groupBy: robot =>\n      (robot.pos.x.compareTo(middleX), robot.pos.y.compareTo(middleY)) match\n        case (0, _) | (_, 0) => -1\n        case ( 1, -1) => 0\n        case (-1, -1) => 1\n        case (-1,  1) => 2\n        case ( 1,  1) => 3\n    .removed(-1).values.map(_.length).product\n\n  def findEasterEgg: Int =\n    (0 to 10403).find: i =>\n      val newRobots = robots.stepN(i)\n      newRobots.groupBy(_.pos.y).count(_._2.length >= 10) > 15 && newRobots.groupBy(_.pos.x).count(_._2.length >= 15) >= 3\n    .getOrElse(-1)\n\ndef part1(input: String): Int = parse(input).stepN(100).safety\n\ndef part2(input: String): Int = parse(input).findEasterEgg\n')),(0,o.kt)("h2",{id:"run-it-in-the-browser"},"Run it in the browser"),(0,o.kt)("h3",{id:"part-1-1"},"Part 1"),(0,o.kt)(i.Z,{puzzle:"day14-part1",year:"2024",mdxType:"Solver"}),(0,o.kt)("h3",{id:"part-2-1"},"Part 2"),(0,o.kt)(i.Z,{puzzle:"day14-part2",year:"2024",mdxType:"Solver"}),(0,o.kt)("h2",{id:"solutions-from-the-community"},"Solutions from the community"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/nikiforo/aoc24/blob/main/src/main/scala/io/github/nikiforo/aoc24/D14T2.scala"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/nikiforo"},"Artem Nikiforov")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/rmarbeck/advent2024/blob/main/day14/src/main/scala/Solution.scala"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/rmarbeck"},"Rapha\xebl Marbeck")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/scarf005/aoc-scala/blob/main/2024/day14.scala"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/scarf005"},"scarf")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/aamiguet/advent-2024/blob/main/src/main/scala/ch/aamiguet/advent2024/Day14.scala"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/aamiguet"},"Antoine Amiguet")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/AlexMckey/AoC2024_Scala/blob/master/src/year2024/day14.scala"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/AlexMckey"},"Alex Mc'key")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/spamegg1/aoc/blob/master/2024/14/14.scala#L165"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/spamegg1"},"Spamegg")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/jnclt/adventofcode2024/blob/main/day14/restroom-redoubt.sc"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/jnclt"},"jnclt")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/Philippus/adventofcode/blob/main/src/main/scala/adventofcode2024/Day14.scala"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/philippus"},"Philippus Baalman")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/jportway/advent2024/blob/master/src/main/scala/Day14.scala"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/jportway"},"Joshua Portway")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/AvaPL/Advent-of-Code-2024/tree/main/src/main/scala/day14"},"Solution")," by ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/AvaPL"},"Pawe\u0142 Cembaluk"))),(0,o.kt)("p",null,"Share your solution to the Scala community by editing this page.\nYou can even write the whole article! ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/scalacenter/scala-advent-of-code/discussions/424"},"See here for the expected format")))}m.isMDXComponent=!0}}]);